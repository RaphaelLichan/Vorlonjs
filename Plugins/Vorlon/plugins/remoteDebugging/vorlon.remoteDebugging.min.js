var __extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);o.prototype=t.prototype,e.prototype=new o},VORLON;!function(e){var t=function(){function e(){}return e}();e.Location=t;var o=function(){function e(){}return e}();e.evaluateOnCallFrame=o;var r=function(r){function i(){r.call(this,"RemoteDebugging","control.html","control.css"),this._ready=!1}return __extends(i,r),i.prototype.getID=function(){return"RemoteDebugging"},i.prototype._markForRefresh=function(){var e=this;this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){e.refresh()},1e4)},i.prototype.refresh=function(){},i.prototype._getTab=function(e){var t=null;return e.forEach(function(e){-1!=e.title.toLowerCase().indexOf("demo")&&(t=e)}),t},i.prototype._packageJson=function(){var e={type:"json",json:JSON.stringify(this.item)};return e},i.prototype.onRealtimeMessageReceivedFromDashboardSide=function(t){var o,r=this,i=new XMLHttpRequest;if(t&&t.type)switch(t.type){case"getJSON":i.open("GET","http://localhost:9222/json",!0),i.withCredentials=!0,i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(o=JSON.parse(i.responseText),r.item=r._getTab(o),e.Core.Messenger.sendRealtimeMessage(r.getID(),r._packageJson(),e.RuntimeSide.Client))},i.send()}else;},i.prototype.startDashboardSide=function(t){void 0===t&&(t=null),e.Core.Messenger.sendRealtimeMessage(this.getID(),{type:"getJSON",order:null},e.RuntimeSide.Dashboard),this._index=0,this._scriptsParsed={},this._timeout=null,this._ready=!0},i.prototype._connectWithClient=function(e){var t=this,o=JSON.parse(e.json),r="";o&&o.webSocketDebuggerUrl&&(r=o.webSocketDebuggerUrl,this._socket=new WebSocket(r),this._socket.onopen=function(){if(t._socket.readyState===WebSocket.OPEN){var e={method:"Debugger.enable",id:t._index++};t._socket.send(JSON.stringify(e))}},this._socket.onerror=function(){},this._socket.onmessage=function(e){var o={};if(e&&e.data){var r=JSON.parse(e.data);if(r.method&&"Debugger.scriptParsed"===r.method&&t._scriptParsed(r),r&&r.result){var i=r.result;if(i.scriptSource){var n=t._scriptsParsed[r.id];n.scriptSource=i.scriptSource,t._timeout||3!=n.startLine||(t._timeout=setTimeout(function(){t._displayScript(n)},1e3))}else i.breakpointId?console.log("Breakpoint added:",i):i.result&&(console.log("Result expression: ",i.result),o={id:t._index++,method:"Debugger.resume"},t._socket.send(JSON.stringify(o)))}r.method&&"Debugger.paused"===r.method&&t._debuggerPaused(r)}})},i.prototype._scriptParsed=function(e){var t=this._index++,o={id:t,method:"Debugger.getScriptSource",params:{scriptId:e.params.scriptId.toString()}};this._scriptsParsed[t]=e.params,this._socket.send(JSON.stringify(o))},i.prototype._displayScript=function(e){this._setBreakPoint(e)},i.prototype._setBreakPoint=function(e){var o=new t;o.columnNumber=0,o.lineNumber=8,o.scriptId=e.scriptId;var r={id:this._index++,method:"Debugger.setBreakpoint",params:{location:o}};this._socket.send(JSON.stringify(r))},i.prototype._debuggerPaused=function(e){var t=e.params.callFrames[0],r=new o;r.callFrameId=t.callFrameId,r.expression="i + j",r.objectGroup="",r.returnByValue=!0;var i={id:this._index++,method:"Debugger.evaluateOnCallFrame",params:r};this._socket.send(JSON.stringify(i))},i.prototype.onRealtimeMessageReceivedFromClientSide=function(e){e&&"json"===e.type&&("null"!==e.json?this._connectWithClient(e):console.log("Failed connection!"))},i}(e.Plugin);e.remoteDebugging=r,e.Core.RegisterPlugin(new r)}(VORLON||(VORLON={}));